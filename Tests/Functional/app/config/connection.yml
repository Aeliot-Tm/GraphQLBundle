imports:
    - { resource: config.yml }

services:
    overblog_graphql.test.resolver.node:
        class: Overblog\GraphQLBundle\Tests\Functional\app\Resolver\ConnectionResolver
        tags:
            - { name: "overblog_graphql.resolver", alias: "friends", method: "friendsResolver" }
            - { name: "overblog_graphql.resolver", alias: "node", method: "resolveNode" }
            - { name: "overblog_graphql.resolver", alias: "query", method: "resolveQuery" }
            - { name: "overblog_graphql.resolver", alias: "connection", method: "resolveConnection" }

overblog_graphql:
    definitions:
        schema:
            query: Query
            mutation: ~
        types:
            Query:
                type: object
                config:
                    fields:
                        user:
                            type: User
                            resolve: '@=resolver("query")'

            User:
                type: object
                config:
                    fields:
                        name:
                            type: String
                        friends:
                            type: friendConnection
                            argsBuilder: ConnectionArgs
                            resolve: '@=resolver("friends", [value, args])'
                        friendsForward:
                            type: userConnection
                            argsBuilder: ForwardConnectionArgs
                            resolve: '@=resolver("friends", [value, args])'
                        friendsBackward:
                            type: userConnection
                            argsBuilder: BackwardConnectionArgs
                            resolve: '@=resolver("friends", [value, args])'

            friendConnection:
                type: relay-connection
                config:
                    nodeType: User
                    resolveNode: '@=resolver("node", [value])'
                    edgeFields:
                        friendshipTime:
                            type: String
                            resolve: "Yesterday"
                    connectionFields:
                        totalCount:
                            type: Int
                            resolve: '@=resolver("connection")'

            userConnection:
                type: relay-connection
                config:
                    nodeType: User
                    resolveNode: '@=resolver("node", [value])'
